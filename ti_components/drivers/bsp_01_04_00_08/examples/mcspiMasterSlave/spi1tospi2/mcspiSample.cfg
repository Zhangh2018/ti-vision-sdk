/* ========================================================================== */
/*                      CFG script for the McSPI sample                       */
/* ========================================================================== */

xdc.loadCapsule("utility/bspCommonBIOS.cfg");
var GIO          = xdc.useModule ('ti.sysbios.io.GIO');
var Task         = xdc.useModule ("ti.sysbios.knl.Task");
var IntXbar      = xdc.useModule('ti.sysbios.family.shared.vayu.IntXbar');
var HeapMem      = xdc.useModule ('ti.sysbios.heaps.HeapMem');

/* allocate a config-params object */
var HeapParam = new HeapMem.Params;

/* optionally assign per-instance configs */
HeapParam.size = 0x180000;

/* create an instance-object */
Program.global.myHeap = HeapMem.create(HeapParam);

/* configure the required Heap parameters                                     */
var prms = new HeapMem.Params;
prms.size = 0x4000;
var heap = HeapMem.create(prms);

var Memory = xdc.useModule('xdc.runtime.Memory');
Memory.defaultHeapInstance = heap;

var iomFxns = "Mcspi_IOMFXNS";
var initFxn0 = "user_mcspi0_init";
var initFxn1 = "user_mcspi1_init";
var deviceParams0 = "mcspi0Prms";
var deviceParams1 = "mcspi1Prms";
var deviceId0 = 0;
var deviceId1 = 1;

GIO.addDeviceMeta("/mcspi0", iomFxns, initFxn0, deviceId0, deviceParams0);
GIO.addDeviceMeta("/mcspi1", iomFxns, initFxn1, deviceId1, deviceParams1);

var task0Params = new Task.Params();
task0Params.instance.name = "task0";
task0Params.stackSize = 0x8000;
task0Params.affinity = 0; /* Force to run on Core 0 */
Program.global.task0 = Task.create("&spiSampleTask", task0Params);
