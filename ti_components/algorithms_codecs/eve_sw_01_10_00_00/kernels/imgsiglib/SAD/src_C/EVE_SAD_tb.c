/* ======================================================================== */
/*  TEXAS INSTRUMENTS, INC.                                                 */
/*                                                                          */
/*  NAME                                                                    */
/*      eve_SAD_tb.c                                                        */
/*                                                                          */
/*  Driver file for sum of absolute difference compute for a given block.   */
/*                                                                          */
/*  USAGE                                                                   */
/*      This code is a driver file for testing the 'vcop_SAD'               */
/*  function by injecting it with the same data set as in the               */
/*  assembly testbench functions.                                           */
/*                                                                          */
/*  This testbench then compares the results with the expected output       */
/*  array "EOut" by doing a standard "memcmp" and printing a pass/fail      */
/*  message. If it failed it prints a byte by byte trace.                   */
/*                                                                          */
/*  To build the "C" executable type:                                       */
/*                                                                          */
/*  gcc *.c -lm -o a.out                                                    */
/*==========================================================================*/
/*      Copyright (C) 2009-2012 Texas Instruments Incorporated.             */
/*                      All Rights Reserved                                 */
/*==========================================================================*/


#include <stdio.h>
#include "../inc/EVE_SAD_cn.h"

typedef unsigned char  Uint8;
typedef unsigned short Uint16;
typedef unsigned int   Uint32;

typedef char    Int8;
typedef short   Int16;
typedef int     Int32;

#ifdef __DATA_2__

#define   TRANSPOSE_WIDTH            8
#define   TRANSPOSE_WIDTH_IN_BYTES  (8 * 4)
#define   TRANSPOSE_WIDTH_IN_HW     (8 * 2)

#define   BYTES_IN_HALF_WD   2
#define   BYTES_IN_WORD      4

#define   TWOSIXTY           260 

/*-----------------------------------------------------------------------*/
/* Size of entire frame being processed.                                 */
/*-----------------------------------------------------------------------*/

#define   IMAGE_W           (32)
#define   IMAGE_H           (16)

/*-----------------------------------------------------------------------*/
/* Block size for SAD computation.                                       */
/*-----------------------------------------------------------------------*/

#define   BLK_W             (8)
#define   BLK_H             (8)

/*-----------------------------------------------------------------------*/
/* Size of input block being compared. This is a sub block from the      */
/* input frame.                                                          */
/*-----------------------------------------------------------------------*/

#define   IN_W              (8)
#define   IN_H              (8)

/*-----------------------------------------------------------------------*/
/* Size of reference block over which input block of blk_w X blk_h is    */
/* being compared.                                                       */
/*-----------------------------------------------------------------------*/

#define   REF_W             (32)    
#define   REF_H             (16)

/*-----------------------------------------------------------------------*/
/* Offset values in the horizontal and vertical directions to jump       */
/* to next sub-block in the reference frame to run SAD function over.    */
/*-----------------------------------------------------------------------*/

#define   OFFSET_HORZ       (1)
#define   OFFSET_VERT       (1)

/*-----------------------------------------------------------------------*/
/* Steps in the vertical and horizontal direction --                     */
/* NO_STEPS_HORZ X NO_STEPS_VERT gives the total number of blocks in the */
/* reference frame being compared to the input block.                    */
/*-----------------------------------------------------------------------*/

#define   NO_STEPS_HORZ     (16) // This has to be a multiple of 16
#define   NO_STEPS_VERT     (2)

/*-----------------------------------------------------------------------*/
/* These are the total number of input blocks of size blk_w X blk_h for  */
/* which SAD values are being computed.                                  */
/*-----------------------------------------------------------------------*/

#define   NO_INPUT_BLKS_VERT    3
#define   NO_INPUT_BLKS_HORZ    2

#define   N0                (IMAGE_W * IMAGE_H)
#define   Nout              (NO_STEPS_VERT * NO_STEPS_HORZ)
#define   Ninter            (NO_STEPS_HORZ * NO_STEPS_VERT *  TRANSPOSE_WIDTH_IN_HW)
#define   Nmins             (NO_STEPS_VERT * NO_STEPS_HORZ * BLK_W)

#pragma DATA_SECTION(in_data, "Adata");
char in_data[N0] =
{
  
   0x00, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 0x00,
   0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00,
   0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00,
   0x00, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 0x00,
   0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00,
   0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00,
   0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00,
   0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
};

#pragma DATA_SECTION(ref_data, "Bdata");
char ref_data[N0] =
{
    0x00, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x00, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x00, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x00, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,

    0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
    0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    
};

#pragma DATA_SECTION(ref, "Cdata");
signed int ref[Nout] =
{
    0x00, 0x018, 0x15, 0x2D, 0x8A, 0xA2,
};

#else

#define   TRANSPOSE_WIDTH    8
#define   TRANSPOSE_WIDTH_IN_BYTES  (8 * 4)
#define   TRANSPOSE_WIDTH_IN_HW     (8 * 2)

#define   BYTES_IN_HALF_WD   2
#define   BYTES_IN_WORD      4

#define   TWOSIXTY           260 

/*-----------------------------------------------------------------------*/
/* Size of entire frame being processed.                                 */
/*-----------------------------------------------------------------------*/

#define   IMAGE_W           (32)
#define   IMAGE_H           (16)

/*-----------------------------------------------------------------------*/
/* Block size for SAD computation.                                       */
/*-----------------------------------------------------------------------*/

#define   BLK_W             (16)
#define   BLK_H             (8)

/*-----------------------------------------------------------------------*/
/* Size of input block being compared. This is a sub block from the      */
/* input frame.                                                          */
/*-----------------------------------------------------------------------*/

#define   IN_W              (16)
#define   IN_H              (16)

/*-----------------------------------------------------------------------*/
/* Size of reference block over which input block of blk_w X blk_h is    */
/* being compared.                                                       */
/*-----------------------------------------------------------------------*/

#define   REF_W             (32)    
#define   REF_H             (16)

/*-----------------------------------------------------------------------*/
/* Offset values in the horizontal and vertical directions to jump       */
/* to next sub-block in the reference frame to run SAD function over.    */
/*-----------------------------------------------------------------------*/

#define   OFFSET_HORZ       (1)
#define   OFFSET_VERT       (4)

/*-----------------------------------------------------------------------*/
/* Steps in the vertical and horizontal direction --                     */
/* NO_STEPS_HORZ X NO_STEPS_VERT gives the total number of blocks in the */
/* reference frame being compared to the input block.                    */
/*-----------------------------------------------------------------------*/

#define   NO_STEPS_HORZ     (16) // This has to be a multiple of 16
#define   NO_STEPS_VERT     (2)

/*-----------------------------------------------------------------------*/
/* These are the total number of input blocks of size blk_w X blk_h for  */
/* which SAD values are being computed.                                  */
/*-----------------------------------------------------------------------*/

#define   NO_INPUT_BLKS_VERT    2
#define   NO_INPUT_BLKS_HORZ    3

#define   N0                (IMAGE_W * IMAGE_H)
#define   Nout              (NO_INPUT_BLKS_VERT * NO_INPUT_BLKS_HORZ)
#define   Ninter            (NO_STEPS_HORZ * NO_STEPS_VERT * ( BLK_W + (BLK_W/TRANSPOSE_WIDTH)))
#define   Nmins             (NO_STEPS_VERT * NO_STEPS_HORZ * BLK_W)

#pragma DATA_SECTION(in_data, "Adata");
char in_data[N0] =
{
  
   0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
   0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
   0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
   0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
   0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
   0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,

   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 

   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,

   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 
   0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,

};

#pragma DATA_SECTION(ref_data, "Bdata");
char ref_data[N0] =
{
  0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 
  0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x03, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x03, 0x03, 0x00, 
  0x00, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00,   
  0x03, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,   
  0x30, 0x0a, 0x0a, 0x18, 0x18, 0x18, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x30,   
  0x33, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x33, 
                                                                                                                                                                                            
  0x30, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x30,   
  0x33, 0x09, 0x09, 0x17, 0x17, 0x17, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x33,   
  0x30, 0x08, 0x08, 0x16, 0x16, 0x16, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x30,   
  0x33, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x33,    
  0x33, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x33, 
  0x30, 0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x30, 
  0x33, 0x03, 0x03, 0x00, 0x00, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x33, 
  0x33, 0x03, 0x03, 0x00, 0x00, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x33, 
                                                                                                                                                                                                               
};

#pragma DATA_SECTION(ref, "Cdata");
signed int ref[Nout] =
{
    0x000, 0x031, 0x062, 0x081, 0x0a1, 0x0c1,

};
#endif

#pragma DATA_SECTION(sad_data, "Bdata");
signed short sad_data[N0] = {0};

#pragma DATA_SECTION(inter_array, "Adata");
signed short inter_array[Ninter] = {0};

#pragma DATA_SECTION(min_ary, "Cdata");
short min_ary[Nmins] = {0};

#pragma DATA_SECTION(out, "Cdata");
short out[Nout] = {0};

void print_output();
int  verify_output();

int main()
{
    int ok = 0;

    /*-------------------------------------------------------------------*/
    /* Actual filtering operation happens here as part of the test bench */
    /* and the results are written out so as to be compared with EVE     */
    /* results.                                                          */
    /*-------------------------------------------------------------------*/
 
    vcop_SAD_cn
    ( 
        in_data, 
        ref_data,
        sad_data,
        out,
        BLK_W,  
        BLK_H,
        IN_W,  
        IN_H,
        REF_W,
        REF_H,
        OFFSET_HORZ,
        OFFSET_VERT,
        NO_STEPS_HORZ,
        NO_STEPS_VERT,
        NO_INPUT_BLKS_HORZ,
        NO_INPUT_BLKS_VERT
    ); 
    
   print_output();
   ok =  verify_output();

   return ok;
}


void print_output()
{
   int i, j, k, l, m;

#if 0
   printf("Absolute differences for input blocks\n\n");

   for (i = 0; i < NO_STEPS_VERT; i++)
   {
      for (j = 0; j < NO_STEPS_HORZ; j++)
      {          
          {              
              for (l = 0; l < BLK_W; l++)
              {                 
                  printf("0x%2.2x, ", sad_data[ ( ( ( i * NO_STEPS_HORZ * BLK_W ) + (j * BLK_W) ) + l)]); 
              }
              printf("\n");
          }
          printf("\n");
      }
      printf("\n");
   }
   printf("\n"); 
#endif

   printf("Minimum SADs for input blocks\n\n");

   for ( k = 0; k < NO_INPUT_BLKS_VERT * NO_INPUT_BLKS_HORZ; k++)
       printf("0x%2.3x ", out[k]); 
}


int verify_output()
{
   int ok = 1;
   int i;

   for (i = 0; i < Nout; ++i)
   {
      if (out[i] != ref[i]) 
      {
         ok = 0;
      }
   }

   printf("\n\nSAD C-kernel:  "); 
   printf(ok ? "PASS\n\n" : "FAIL\n\n"); 

   return ok;
}

