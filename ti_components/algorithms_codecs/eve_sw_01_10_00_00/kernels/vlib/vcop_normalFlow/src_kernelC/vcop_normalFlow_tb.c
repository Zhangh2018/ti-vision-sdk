/* ======================================================================== */
/*  TEXAS INSTRUMENTS, INC.                                                 */
/*                                                                          */
/*  NAME                                                                    */
/*      vcop_normalFlow                                                     */
/*                                                                          */
/*  Driver file for testing normal flow distance function                   */
/*                                                                          */
/*  USAGE                                                                   */
/*     This code contains a driver program for testing the 'vcop_normalFlow'*/
/*  function by injecting it with the same data set as in the natural C     */
/*  testbench functions.                                                    */
/*                                                                          */
/*  This testbench then compares the results with the expected output       */
/*  array by doing a standard "memcmp" function and printing a pass/fail    */
/*  message. If it failed it prints a byte by byte trace.                   */
/*                                                                          */
/* ------------------------------------------------------------------------ */
/*      Copyright (C) 2012 Texas Instruments Incorporated.                  */
/*                          All Rights Reserved.                            */
/* ======================================================================== */



#include  <stdio.h>
#include  <stdlib.h>
#include  <string.h>

#include  <vcop.h>

#include "test_profile.h"

#define imW     (8)
#define imH     (8)


#if VCOP_HOST_EMULATION
#include "vcop_normalFlow_kernel.k"  // kernel source
#else

void vcop_generate_TLU_m
(
    __vptr_int16   Emag,
    __vptr_int16   LUT,
           short   numEls,
    __vptr_int16   TLU_m_inv
);

void vcop_normalFlow
(
    __vptr_int16   imDiff,
    __vptr_int16   Emag,
    __vptr_int16   LUT,
    __vptr_int16   E,
    __vptr_int16   TLU_m_inv,
             int   T,
           short   numEls,
    __vptr_int16   normalFlowU,
    __vptr_int16   normalFlowV
);
#endif





#pragma DATA_SECTION(Emag, "IBUFLA");
short Emag[imW*imH] =
{
    0x65, 0x69, 0x6e, 0x72, 0x74, 0x7c, 0x84, 0x85, 
    0xb5, 0xae, 0xbb, 0xc4, 0xc3, 0xca, 0xd2, 0xc9, 
    0x26, 0x0f, 0x3c, 0x32, 0x32, 0x35, 0x30, 0x23, 
    0x26, 0x0a, 0x3b, 0x03, 0x06, 0x0c, 0x09, 0x15, 
    0x3e, 0x2b, 0x2a, 0x0d, 0x0a, 0x07, 0x06, 0x13, 
    0x13, 0x1d, 0x0f, 0x2a, 0x11, 0x03, 0x05, 0x05, 
    0x06, 0x21, 0x2b, 0x36, 0x30, 0x12, 0x14, 0x0f, 
    0x06, 0x1a, 0x32, 0x15, 0x2d, 0x09, 0x05, 0x09 
};

#pragma DATA_SECTION(LUT, "IBUFLB");
short LUT[] =
{
    0x0000, 0x7fff, 0x0000, 0x7fff, 0x0000, 
    0x7fff, 0x0000, 0x7fff, 0x0000, 0x7fff, 
    0x0000, 0x7fff, 0x0000, 0x7fff, 0x0000, 
    0x7fff, 0x3fff, 0x2aaa, 0x3fff, 0x2aaa, 
    0x3fff, 0x2aaa, 0x3fff, 0x2aaa, 0x3fff, 
    0x2aaa, 0x3fff, 0x2aaa, 0x3fff, 0x2aaa,
    0x3fff, 0x2aaa, 0x1fff, 0x1999, 0x1fff,
    0x1999, 0x1fff, 0x1999, 0x1fff, 0x1999,
    0x1fff, 0x1999, 0x1fff, 0x1999, 0x1fff,
    0x1999, 0x1fff, 0x1999, 0x1555, 0x1249,
    0x1555, 0x1249, 0x1555, 0x1249, 0x1555,
    0x1249, 0x1555, 0x1249, 0x1555, 0x1249,
    0x1555, 0x1249, 0x1555, 0x1249, 0x0fff,
    0x0e38, 0x0fff, 0x0e38, 0x0fff, 0x0e38,
    0x0fff, 0x0e38, 0x0fff, 0x0e38, 0x0fff,
    0x0e38, 0x0fff, 0x0e38, 0x0fff, 0x0e38,
    0x0ccc, 0x0ba2, 0x0ccc, 0x0ba2, 0x0ccc,
    0x0ba2, 0x0ccc, 0x0ba2, 0x0ccc, 0x0ba2,
    0x0ccc, 0x0ba2, 0x0ccc, 0x0ba2, 0x0ccc,
    0x0ba2, 0x0aaa, 0x09d8, 0x0aaa, 0x09d8,
    0x0aaa, 0x09d8, 0x0aaa, 0x09d8, 0x0aaa,
    0x09d8, 0x0aaa, 0x09d8, 0x0aaa, 0x09d8,
    0x0aaa, 0x09d8, 0x0924, 0x0888, 0x0924,
    0x0888, 0x0924, 0x0888, 0x0924, 0x0888,
    0x0924, 0x0888, 0x0924, 0x0888, 0x0924,
    0x0888, 0x0924, 0x0888, 0x07ff, 0x0787,
    0x07ff, 0x0787, 0x07ff, 0x0787, 0x07ff,
    0x0787, 0x07ff, 0x0787, 0x07ff, 0x0787,
    0x07ff, 0x0787, 0x07ff, 0x0787, 0x071c,
    0x06bc, 0x071c, 0x06bc, 0x071c, 0x06bc,
    0x071c, 0x06bc, 0x071c, 0x06bc, 0x071c,
    0x06bc, 0x071c, 0x06bc, 0x071c, 0x06bc,
    0x0666, 0x0618, 0x0666, 0x0618, 0x0666,
    0x0618, 0x0666, 0x0618, 0x0666, 0x0618,
    0x0666, 0x0618, 0x0666, 0x0618, 0x0666,
    0x0618, 0x05d1, 0x0590, 0x05d1, 0x0590,
    0x05d1, 0x0590, 0x05d1, 0x0590, 0x05d1,
    0x0590, 0x05d1, 0x0590, 0x05d1, 0x0590,
    0x05d1, 0x0590, 0x0555, 0x051e, 0x0555,
    0x051e, 0x0555, 0x051e, 0x0555, 0x051e,
    0x0555, 0x051e, 0x0555, 0x051e, 0x0555,
    0x051e, 0x0555, 0x051e, 0x04ec, 0x04bd,
    0x04ec, 0x04bd, 0x04ec, 0x04bd, 0x04ec,
    0x04bd, 0x04ec, 0x04bd, 0x04ec, 0x04bd,
    0x04ec, 0x04bd, 0x04ec, 0x04bd, 0x0492,
    0x0469, 0x0492, 0x0469, 0x0492, 0x0469,
    0x0492, 0x0469, 0x0492, 0x0469, 0x0492,
    0x0469, 0x0492, 0x0469, 0x0492, 0x0469,
    0x0444, 0x0421, 0x0444, 0x0421, 0x0444,
    0x0421, 0x0444, 0x0421, 0x0444, 0x0421,
    0x0444, 0x0421, 0x0444, 0x0421, 0x0444,
    0x0421, 0x03ff, 0x03e0, 0x03ff, 0x03e0,
    0x03ff, 0x03e0, 0x03ff, 0x03e0, 0x03ff,
    0x03e0, 0x03ff, 0x03e0, 0x03ff, 0x03e0,
    0x03ff, 0x03e0, 0x03c3, 0x03a8, 0x03c3,
    0x03a8, 0x03c3, 0x03a8, 0x03c3, 0x03a8,
    0x03c3, 0x03a8, 0x03c3, 0x03a8, 0x03c3,
    0x03a8, 0x03c3, 0x03a8, 0x038e, 0x0375,
    0x038e, 0x0375, 0x038e, 0x0375, 0x038e,
    0x0375, 0x038e, 0x0375, 0x038e, 0x0375,
    0x038e, 0x0375, 0x038e, 0x0375, 0x035e,
    0x0348, 0x035e, 0x0348, 0x035e, 0x0348,
    0x035e, 0x0348, 0x035e, 0x0348, 0x035e,
    0x0348, 0x035e, 0x0348, 0x035e, 0x0348,
    0x0333, 0x031f, 0x0333, 0x031f, 0x0333,
    0x031f, 0x0333, 0x031f, 0x0333, 0x031f,
    0x0333, 0x031f, 0x0333, 0x031f, 0x0333,
    0x031f, 0x030c, 0x02fa, 0x030c, 0x02fa,
    0x030c, 0x02fa, 0x030c, 0x02fa, 0x030c,
    0x02fa, 0x030c, 0x02fa, 0x030c, 0x02fa,
    0x030c, 0x02fa, 0x02e8, 0x02d8, 0x02e8,
    0x02d8, 0x02e8, 0x02d8, 0x02e8, 0x02d8,
    0x02e8, 0x02d8, 0x02e8, 0x02d8, 0x02e8,
    0x02d8, 0x02e8, 0x02d8, 0x02c8, 0x02b9,
    0x02c8, 0x02b9, 0x02c8, 0x02b9, 0x02c8,
    0x02b9, 0x02c8, 0x02b9, 0x02c8, 0x02b9,
    0x02c8, 0x02b9, 0x02c8, 0x02b9, 0x02aa,
    0x029c, 0x02aa, 0x029c, 0x02aa, 0x029c,
    0x02aa, 0x029c, 0x02aa, 0x029c, 0x02aa,
    0x029c, 0x02aa, 0x029c, 0x02aa, 0x029c,
    0x028f, 0x0282, 0x028f, 0x0282, 0x028f,
    0x0282, 0x028f, 0x0282, 0x028f, 0x0282,
    0x028f, 0x0282, 0x028f, 0x0282, 0x028f,
    0x0282, 0x0276, 0x026a, 0x0276, 0x026a,
    0x0276, 0x026a, 0x0276, 0x026a, 0x0276,
    0x026a, 0x0276, 0x026a, 0x0276, 0x026a,
    0x0276, 0x026a, 0x025e, 0x0253, 0x025e,
    0x0253, 0x025e, 0x0253, 0x025e, 0x0253,
    0x025e, 0x0253, 0x025e, 0x0253, 0x025e,
    0x0253, 0x025e, 0x0253, 0x0249, 0x023e,
    0x0249, 0x023e, 0x0249, 0x023e, 0x0249,
    0x023e, 0x0249, 0x023e, 0x0249, 0x023e,
    0x0249, 0x023e, 0x0249, 0x023e, 0x0234,
    0x022b, 0x0234, 0x022b, 0x0234, 0x022b,
    0x0234, 0x022b, 0x0234, 0x022b, 0x0234,
    0x022b, 0x0234, 0x022b, 0x0234, 0x022b,
    0x0222, 0x0219, 0x0222, 0x0219, 0x0222,
    0x0219, 0x0222, 0x0219, 0x0222, 0x0219,
    0x0222, 0x0219, 0x0222, 0x0219, 0x0222,
    0x0219, 0x0210, 0x0208, 0x0210, 0x0208,
    0x0210, 0x0208, 0x0210, 0x0208, 0x0210,
    0x0208, 0x0210, 0x0208, 0x0210, 0x0208,
    0x0210, 0x0208, 0x01ff, 0x01f8, 0x01ff,
    0x01f8, 0x01ff, 0x01f8, 0x01ff, 0x01f8,
    0x01ff, 0x01f8, 0x01ff, 0x01f8, 0x01ff,
    0x01f8, 0x01ff, 0x01f8, 0x01f0, 0x01e9,
    0x01f0, 0x01e9, 0x01f0, 0x01e9, 0x01f0,
    0x01e9, 0x01f0, 0x01e9, 0x01f0, 0x01e9,
    0x01f0, 0x01e9, 0x01f0, 0x01e9, 0x01e1,
    0x01da, 0x01e1, 0x01da, 0x01e1, 0x01da,
    0x01e1, 0x01da, 0x01e1, 0x01da, 0x01e1,
    0x01da, 0x01e1, 0x01da, 0x01e1, 0x01da,
    0x01d4, 0x01cd, 0x01d4, 0x01cd, 0x01d4,
    0x01cd, 0x01d4, 0x01cd, 0x01d4, 0x01cd,
    0x01d4, 0x01cd, 0x01d4, 0x01cd, 0x01d4,
    0x01cd, 0x01c7, 0x01c0, 0x01c7, 0x01c0,
    0x01c7, 0x01c0, 0x01c7, 0x01c0, 0x01c7,
    0x01c0, 0x01c7, 0x01c0, 0x01c7, 0x01c0,
    0x01c7, 0x01c0, 0x01ba, 0x01b4, 0x01ba,
    0x01b4, 0x01ba, 0x01b4, 0x01ba, 0x01b4,
    0x01ba, 0x01b4, 0x01ba, 0x01b4, 0x01ba,
    0x01b4, 0x01ba, 0x01b4, 0x01af, 0x01a9,
    0x01af, 0x01a9, 0x01af, 0x01a9, 0x01af,
    0x01a9, 0x01af, 0x01a9, 0x01af, 0x01a9,
    0x01af, 0x01a9, 0x01af, 0x01a9, 0x01a4,
    0x019e, 0x01a4, 0x019e, 0x01a4, 0x019e,
    0x01a4, 0x019e, 0x01a4, 0x019e, 0x01a4,
    0x019e, 0x01a4, 0x019e, 0x01a4, 0x019e,
    0x0199, 0x0194, 0x0199, 0x0194, 0x0199,
    0x0194, 0x0199, 0x0194, 0x0199, 0x0194,
    0x0199, 0x0194, 0x0199, 0x0194, 0x0199,
    0x0194, 0x018f, 0x018a, 0x018f, 0x018a,
    0x018f, 0x018a, 0x018f, 0x018a, 0x018f,
    0x018a, 0x018f, 0x018a, 0x018f, 0x018a,
    0x018f, 0x018a, 0x0186, 0x0181, 0x0186,
    0x0181, 0x0186, 0x0181, 0x0186, 0x0181,
    0x0186, 0x0181, 0x0186, 0x0181, 0x0186,
    0x0181, 0x0186, 0x0181, 0x017d, 0x0178,
    0x017d, 0x0178, 0x017d, 0x0178, 0x017d,
    0x0178, 0x017d, 0x0178, 0x017d, 0x0178,
    0x017d, 0x0178, 0x017d, 0x0178, 0x0174,
    0x0170, 0x0174, 0x0170, 0x0174, 0x0170,
    0x0174, 0x0170, 0x0174, 0x0170, 0x0174,
    0x0170, 0x0174, 0x0170, 0x0174, 0x0170,
    0x016c, 0x0168, 0x016c, 0x0168, 0x016c,
    0x0168, 0x016c, 0x0168, 0x016c, 0x0168,
    0x016c, 0x0168, 0x016c, 0x0168, 0x016c,
    0x0168, 0x0164, 0x0160, 0x0164, 0x0160,
    0x0164, 0x0160, 0x0164, 0x0160, 0x0164,
    0x0160, 0x0164, 0x0160, 0x0164, 0x0160,
    0x0164, 0x0160, 0x015c, 0x0158, 0x015c,
    0x0158, 0x015c, 0x0158, 0x015c, 0x0158,
    0x015c, 0x0158, 0x015c, 0x0158, 0x015c,
    0x0158, 0x015c, 0x0158, 0x0155, 0x0151,
    0x0155, 0x0151, 0x0155, 0x0151, 0x0155,
    0x0151, 0x0155, 0x0151, 0x0155, 0x0151,
    0x0155, 0x0151, 0x0155, 0x0151, 0x014e,
    0x014a, 0x014e, 0x014a, 0x014e, 0x014a,
    0x014e, 0x014a, 0x014e, 0x014a, 0x014e,
    0x014a, 0x014e, 0x014a, 0x014e, 0x014a,
    0x0147, 0x0144, 0x0147, 0x0144, 0x0147,
    0x0144, 0x0147, 0x0144, 0x0147, 0x0144,
    0x0147, 0x0144, 0x0147, 0x0144, 0x0147,
    0x0144, 0x0141, 0x013e, 0x0141, 0x013e,
    0x0141, 0x013e, 0x0141, 0x013e, 0x0141,
    0x013e, 0x0141, 0x013e, 0x0141, 0x013e,
    0x0141, 0x013e, 0x013b, 0x0138, 0x013b,
    0x0138, 0x013b, 0x0138, 0x013b, 0x0138,
    0x013b, 0x0138, 0x013b, 0x0138, 0x013b,
    0x0138, 0x013b, 0x0138, 0x0135, 0x0132,
    0x0135, 0x0132, 0x0135, 0x0132, 0x0135,
    0x0132, 0x0135, 0x0132, 0x0135, 0x0132,
    0x0135, 0x0132, 0x0135, 0x0132, 0x012f, 
    0x012c, 0x012f, 0x012c, 0x012f, 0x012c, 
    0x012f, 0x012c, 0x012f, 0x012c, 0x012f, 
    0x012c, 0x012f, 0x012c, 0x012f, 0x012c,
    0x0129, 0x0127, 0x0129, 0x0127, 0x0129, 
    0x0127, 0x0129, 0x0127, 0x0129, 0x0127, 
    0x0129, 0x0127, 0x0129, 0x0127, 0x0129, 
    0x0127, 0x0124, 0x0121, 0x0124, 0x0121, 
    0x0124, 0x0121, 0x0124, 0x0121, 0x0124, 
    0x0121, 0x0124, 0x0121, 0x0124, 0x0121, 
    0x0124, 0x0121, 0x011f, 0x011c, 0x011f, 
    0x011c, 0x011f, 0x011c, 0x011f, 0x011c, 
    0x011f, 0x011c, 0x011f, 0x011c, 0x011f, 
    0x011c, 0x011f, 0x011c, 0x011a, 0x0118, 
    0x011a, 0x0118, 0x011a, 0x0118, 0x011a, 
    0x0118, 0x011a, 0x0118, 0x011a, 0x0118, 
    0x011a, 0x0118, 0x011a, 0x0118, 0x0115, 
    0x0113, 0x0115, 0x0113, 0x0115, 0x0113, 
    0x0115, 0x0113, 0x0115, 0x0113, 0x0115, 
    0x0113, 0x0115, 0x0113, 0x0115, 0x0113,
    0x0111, 0x010e, 0x0111, 0x010e, 0x0111, 
    0x010e, 0x0111, 0x010e, 0x0111, 0x010e, 
    0x0111, 0x010e, 0x0111, 0x010e, 0x0111, 
    0x010e, 0x010c, 0x010a, 0x010c, 0x010a, 
    0x010c, 0x010a, 0x010c, 0x010a, 0x010c, 
    0x010a, 0x010c, 0x010a, 0x010c, 0x010a, 
    0x010c, 0x010a, 0x0108, 0x0106, 0x0108, 
    0x0106, 0x0108, 0x0106, 0x0108, 0x0106, 
    0x0108, 0x0106, 0x0108, 0x0106, 0x0108, 
    0x0106, 0x0108, 0x0106, 0x0104, 0x0102, 
    0x0104, 0x0102, 0x0104, 0x0102, 0x0104, 
    0x0102, 0x0104, 0x0102, 0x0104, 0x0102, 
    0x0104, 0x0102, 0x0104, 0x0102, 0x00ff, 
    0x00fe, 0x00ff, 0x00fe, 0x00ff, 0x00fe, 
    0x00ff, 0x00fe, 0x00ff, 0x00fe, 0x00ff, 
    0x00fe, 0x00ff, 0x00fe, 0x00ff, 0x00fe,
    0x00fc, 0x00fa, 0x00fc, 0x00fa, 0x00fc, 
    0x00fa, 0x00fc, 0x00fa, 0x00fc, 0x00fa, 
    0x00fc, 0x00fa, 0x00fc, 0x00fa, 0x00fc, 
    0x00fa, 0x00f8, 0x00f6, 0x00f8, 0x00f6, 
    0x00f8, 0x00f6, 0x00f8, 0x00f6, 0x00f8, 
    0x00f6, 0x00f8, 0x00f6, 0x00f8, 0x00f6, 
    0x00f8, 0x00f6, 0x00f4, 0x00f2, 0x00f4, 
    0x00f2, 0x00f4, 0x00f2, 0x00f4, 0x00f2, 
    0x00f4, 0x00f2, 0x00f4, 0x00f2, 0x00f4, 
    0x00f2, 0x00f4, 0x00f2, 0x00f0, 0x00ef, 
    0x00f0, 0x00ef, 0x00f0, 0x00ef, 0x00f0, 
    0x00ef, 0x00f0, 0x00ef, 0x00f0, 0x00ef, 
    0x00f0, 0x00ef, 0x00f0, 0x00ef, 0x00ed, 
    0x00eb, 0x00ed, 0x00eb, 0x00ed, 0x00eb, 
    0x00ed, 0x00eb, 0x00ed, 0x00eb, 0x00ed, 
    0x00eb, 0x00ed, 0x00eb, 0x00ed, 0x00eb,
    0x00ea, 0x00e8, 0x00ea, 0x00e8, 0x00ea, 
    0x00e8, 0x00ea, 0x00e8, 0x00ea, 0x00e8, 
    0x00ea, 0x00e8, 0x00ea, 0x00e8, 0x00ea, 
    0x00e8, 0x00e6, 0x00e5, 0x00e6, 0x00e5, 
    0x00e6, 0x00e5, 0x00e6, 0x00e5, 0x00e6, 
    0x00e5, 0x00e6, 0x00e5, 0x00e6, 0x00e5, 
    0x00e6, 0x00e5, 0x00e3, 0x00e1, 0x00e3, 
    0x00e1, 0x00e3, 0x00e1, 0x00e3, 0x00e1, 
    0x00e3, 0x00e1, 0x00e3, 0x00e1, 0x00e3, 
    0x00e1, 0x00e3, 0x00e1, 0x00e0, 0x00de, 
    0x00e0, 0x00de, 0x00e0, 0x00de, 0x00e0, 
    0x00de, 0x00e0, 0x00de, 0x00e0, 0x00de, 
    0x00e0, 0x00de, 0x00e0, 0x00de, 0x00dd, 
    0x00db, 0x00dd, 0x00db, 0x00dd, 0x00db, 
    0x00dd, 0x00db, 0x00dd, 0x00db, 0x00dd, 
    0x00db, 0x00dd, 0x00db, 0x00dd, 0x00db,
    0x00da, 0x00d9, 0x00da, 0x00d9, 0x00da, 
    0x00d9, 0x00da, 0x00d9, 0x00da, 0x00d9, 
    0x00da, 0x00d9, 0x00da, 0x00d9, 0x00da, 
    0x00d9, 0x00d7, 0x00d6, 0x00d7, 0x00d6, 
    0x00d7, 0x00d6, 0x00d7, 0x00d6, 0x00d7, 
    0x00d6, 0x00d7, 0x00d6, 0x00d7, 0x00d6, 
    0x00d7, 0x00d6, 0x00d4, 0x00d3, 0x00d4, 
    0x00d3, 0x00d4, 0x00d3, 0x00d4, 0x00d3, 
    0x00d4, 0x00d3, 0x00d4, 0x00d3, 0x00d4, 
    0x00d3, 0x00d4, 0x00d3, 0x00d2, 0x00d0, 
    0x00d2, 0x00d0, 0x00d2, 0x00d0, 0x00d2, 
    0x00d0, 0x00d2, 0x00d0, 0x00d2, 0x00d0, 
    0x00d2, 0x00d0, 0x00d2, 0x00d0, 0x00cf, 
    0x00ce, 0x00cf, 0x00ce, 0x00cf, 0x00ce, 
    0x00cf, 0x00ce, 0x00cf, 0x00ce, 0x00cf, 
    0x00ce, 0x00cf, 0x00ce, 0x00cf, 0x00ce,
    0x00cc, 0x00cb, 0x00cc, 0x00cb, 0x00cc, 
    0x00cb, 0x00cc, 0x00cb, 0x00cc, 0x00cb, 
    0x00cc, 0x00cb, 0x00cc, 0x00cb, 0x00cc, 
    0x00cb, 0x00ca, 0x00c9, 0x00ca, 0x00c9, 
    0x00ca, 0x00c9, 0x00ca, 0x00c9, 0x00ca, 
    0x00c9, 0x00ca, 0x00c9, 0x00ca, 0x00c9, 
    0x00ca, 0x00c9, 0x00c7, 0x00c6, 0x00c7, 
    0x00c6, 0x00c7, 0x00c6, 0x00c7, 0x00c6, 
    0x00c7, 0x00c6, 0x00c7, 0x00c6, 0x00c7, 
    0x00c6, 0x00c7, 0x00c6, 0x00c5, 0x00c4, 
    0x00c5, 0x00c4, 0x00c5, 0x00c4, 0x00c5, 
    0x00c4, 0x00c5, 0x00c4, 0x00c5, 0x00c4, 
    0x00c5, 0x00c4, 0x00c5, 0x00c4, 0x00c3, 
    0x00c1, 0x00c3, 0x00c1, 0x00c3, 0x00c1, 
    0x00c3, 0x00c1, 0x00c3, 0x00c1, 0x00c3, 
    0x00c1, 0x00c3, 0x00c1, 0x00c3, 0x00c1,
    0x00c0, 0x00bf, 0x00c0, 0x00bf, 0x00c0, 
    0x00bf, 0x00c0, 0x00bf, 0x00c0, 0x00bf, 
    0x00c0, 0x00bf, 0x00c0, 0x00bf, 0x00c0, 
    0x00bf, 0x00be, 0x00bd, 0x00be, 0x00bd, 
    0x00be, 0x00bd, 0x00be, 0x00bd, 0x00be, 
    0x00bd, 0x00be, 0x00bd, 0x00be, 0x00bd, 
    0x00be, 0x00bd, 0x00bc, 0x00bb, 0x00bc, 
    0x00bb, 0x00bc, 0x00bb, 0x00bc, 0x00bb, 
    0x00bc, 0x00bb, 0x00bc, 0x00bb, 0x00bc, 
    0x00bb, 0x00bc, 0x00bb, 0x00ba, 0x00b9, 
    0x00ba, 0x00b9, 0x00ba, 0x00b9, 0x00ba, 
    0x00b9, 0x00ba, 0x00b9, 0x00ba, 0x00b9, 
    0x00ba, 0x00b9, 0x00ba, 0x00b9, 0x00b8, 
    0x00b7, 0x00b8, 0x00b7, 0x00b8, 0x00b7, 
    0x00b8, 0x00b7, 0x00b8, 0x00b7, 0x00b8, 
    0x00b7, 0x00b8, 0x00b7, 0x00b8, 0x00b7,
    0x00b6, 0x00b5, 0x00b6, 0x00b5, 0x00b6, 
    0x00b5, 0x00b6, 0x00b5, 0x00b6, 0x00b5, 
    0x00b6, 0x00b5, 0x00b6, 0x00b5, 0x00b6, 
    0x00b5, 0x00b4, 0x00b3, 0x00b4, 0x00b3, 
    0x00b4, 0x00b3, 0x00b4, 0x00b3, 0x00b4, 
    0x00b3, 0x00b4, 0x00b3, 0x00b4, 0x00b3, 
    0x00b4, 0x00b3, 0x00b2, 0x00b1, 0x00b2, 
    0x00b1, 0x00b2, 0x00b1, 0x00b2, 0x00b1, 
    0x00b2, 0x00b1, 0x00b2, 0x00b1, 0x00b2, 
    0x00b1, 0x00b2, 0x00b1, 0x00b0, 0x00af, 
    0x00b0, 0x00af, 0x00b0, 0x00af, 0x00b0, 
    0x00af, 0x00b0, 0x00af, 0x00b0, 0x00af, 
    0x00b0, 0x00af, 0x00b0, 0x00af, 0x00ae, 
    0x00ad, 0x00ae, 0x00ad, 0x00ae, 0x00ad, 
    0x00ae, 0x00ad, 0x00ae, 0x00ad, 0x00ae, 
    0x00ad, 0x00ae, 0x00ad, 0x00ae, 0x00ad,
    0x00ac, 0x00ab, 0x00ac, 0x00ab, 0x00ac, 
    0x00ab, 0x00ac, 0x00ab, 0x00ac, 0x00ab,
    0x00ac, 0x00ab, 0x00ac, 0x00ab, 0x00ac, 
    0x00ab, 0x00aa, 0x00a9, 0x00aa, 0x00a9, 
    0x00aa, 0x00a9, 0x00aa, 0x00a9, 0x00aa, 
    0x00a9, 0x00aa, 0x00a9, 0x00aa, 0x00a9, 
    0x00aa, 0x00a9, 0x00a8, 0x00a8, 0x00a8, 
    0x00a8, 0x00a8, 0x00a8, 0x00a8, 0x00a8, 
    0x00a8, 0x00a8, 0x00a8, 0x00a8, 0x00a8, 
    0x00a8, 0x00a8, 0x00a8, 0x00a7, 0x00a6, 
    0x00a7, 0x00a6, 0x00a7, 0x00a6, 0x00a7, 
    0x00a6, 0x00a7, 0x00a6, 0x00a7, 0x00a6, 
    0x00a7, 0x00a6, 0x00a7, 0x00a6, 0x00a5, 
    0x00a4, 0x00a5, 0x00a4, 0x00a5, 0x00a4, 
    0x00a5, 0x00a4, 0x00a5, 0x00a4, 0x00a5, 
    0x00a4, 0x00a5, 0x00a4, 0x00a5, 0x00a4,
    0x00a3, 0x00a3, 0x00a3, 0x00a3, 0x00a3, 
    0x00a3, 0x00a3, 0x00a3, 0x00a3, 0x00a3, 
    0x00a3, 0x00a3, 0x00a3, 0x00a3, 0x00a3, 
    0x00a3, 0x00a2, 0x00a1, 0x00a2, 0x00a1, 
    0x00a2, 0x00a1, 0x00a2, 0x00a1, 0x00a2, 
    0x00a1, 0x00a2, 0x00a1, 0x00a2, 0x00a1, 
    0x00a2, 0x00a1, 0x00a0, 0x009f, 0x00a0, 
    0x009f, 0x00a0, 0x009f, 0x00a0, 0x009f, 
    0x00a0, 0x009f, 0x00a0, 0x009f, 0x00a0, 
    0x009f, 0x00a0, 0x009f, 0x009f, 0x009e, 
    0x009f, 0x009e, 0x009f, 0x009e, 0x009f, 
    0x009e, 0x009f, 0x009e, 0x009f, 0x009e, 
    0x009f, 0x009e, 0x009f, 0x009e, 0x009d, 
    0x009c, 0x009d, 0x009c, 0x009d, 0x009c, 
    0x009d, 0x009c, 0x009d, 0x009c, 0x009d, 
    0x009c, 0x009d, 0x009c, 0x009d, 0x009c,
    0x009c, 0x009b, 0x009c, 0x009b, 0x009c,
    0x009b, 0x009c, 0x009b, 0x009c, 0x009b, 
    0x009c, 0x009b, 0x009c, 0x009b, 0x009c, 
    0x009b, 0x009a, 0x0099, 0x009a, 0x0099, 
    0x009a, 0x0099, 0x009a, 0x0099, 0x009a, 
    0x0099, 0x009a, 0x0099, 0x009a, 0x0099, 
    0x009a, 0x0099, 0x0099, 0x0098, 0x0099, 
    0x0098, 0x0099, 0x0098, 0x0099, 0x0098, 
    0x0099, 0x0098, 0x0099, 0x0098, 0x0099, 
    0x0098, 0x0099, 0x0098, 0x0097, 0x0097, 
    0x0097, 0x0097, 0x0097, 0x0097, 0x0097, 
    0x0097, 0x0097, 0x0097, 0x0097, 0x0097, 
    0x0097, 0x0097, 0x0097, 0x0097, 0x0096, 
    0x0095, 0x0096, 0x0095, 0x0096, 0x0095, 
    0x0096, 0x0095, 0x0096, 0x0095, 0x0096, 
    0x0095, 0x0096, 0x0095, 0x0096, 0x0095,
    0x0094, 0x0094, 0x0094, 0x0094, 0x0094, 
    0x0094, 0x0094, 0x0094, 0x0094, 0x0094, 
    0x0094, 0x0094, 0x0094, 0x0094, 0x0094, 
    0x0094, 0x0093, 0x0092, 0x0093, 0x0092, 
    0x0093, 0x0092, 0x0093, 0x0092, 0x0093, 
    0x0092, 0x0093, 0x0092, 0x0093, 0x0092, 
    0x0093, 0x0092, 0x0092, 0x0091, 0x0092, 
    0x0091, 0x0092, 0x0091, 0x0092, 0x0091, 
    0x0092, 0x0091, 0x0092, 0x0091, 0x0092, 
    0x0091, 0x0092, 0x0091, 0x0090, 0x0090, 
    0x0090, 0x0090, 0x0090, 0x0090, 0x0090, 
    0x0090, 0x0090, 0x0090, 0x0090, 0x0090, 
    0x0090, 0x0090, 0x0090, 0x0090, 0x008f, 
    0x008f, 0x008f, 0x008f, 0x008f, 0x008f, 
    0x008f, 0x008f, 0x008f, 0x008f, 0x008f, 
    0x008f, 0x008f, 0x008f, 0x008f, 0x008f,
    0x008e, 0x008d, 0x008e, 0x008d, 0x008e, 
    0x008d, 0x008e, 0x008d, 0x008e, 0x008d, 
    0x008e, 0x008d, 0x008e, 0x008d, 0x008e, 
    0x008d, 0x008d, 0x008c, 0x008d, 0x008c, 
    0x008d, 0x008c, 0x008d, 0x008c, 0x008d, 
    0x008c, 0x008d, 0x008c, 0x008d, 0x008c, 
    0x008d, 0x008c, 0x008c, 0x008b, 0x008c, 
    0x008b, 0x008c, 0x008b, 0x008c, 0x008b, 
    0x008c, 0x008b, 0x008c, 0x008b, 0x008c, 
    0x008b, 0x008c, 0x008b, 0x008a, 0x0000, 
    0x008a, 0x0000, 0x008a, 0x0000, 0x008a, 
    0x0000, 0x008a, 0x0000, 0x008a, 0x0000, 
    0x008a, 0x0000, 0x008a, 0x0000
};

#pragma DATA_SECTION(TLU_m_inv, "WBUF");
short TLU_m_inv[imW*imH];


#pragma DATA_SECTION(imDiff, "IBUFLA");
short imDiff[imW*imH] =
{
    0xffea, 0xffe3, 0xffe2, 0xffe8, 0xffe8, 0xffe3, 0xffda, 0xffe0,
    0x0075, 0x0077, 0x0079, 0x007f, 0x0080, 0x0080, 0x0082, 0x008a,
    0x0072, 0x0041, 0x005e, 0x006e, 0x005f, 0x0064, 0x005f, 0x0062,
    0xffd9, 0xffea, 0x0000, 0x0000, 0xffea, 0x0000, 0x0000, 0xffe8,
    0x0000, 0x0024, 0x0024, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0xffe4, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0xffe3, 0x0000, 0xffeb, 0x0000, 0x0000
};


#pragma DATA_SECTION(E, "IBUFLA");
short E[2*imW*imH] =
{
    0x0002, 0xff9b, 0x0002, 0xff97, 0xfffc, 0xff92, 0xfffb, 0xff8e,
    0x0000, 0xff8c, 0x000a, 0xff84, 0xffff, 0xff7c, 0xfff3, 0xff7b,
    0x0008, 0xff4b, 0xffff, 0xff52, 0xffed, 0xff45, 0xfffd, 0xff3c,
    0xfffe, 0xff3d, 0xfffd, 0xff36, 0xfffb, 0xff2e, 0xfffd, 0xff37,
    0x001c, 0xffe9, 0xfffa, 0xfff1, 0xffd2, 0xffdd, 0x0000, 0xffce,
    0xfffe, 0xffce, 0xfff4, 0xffcb, 0x0002, 0xffd0, 0x0011, 0xffe2,
    0x0026, 0xfffa, 0xfff7, 0xfffb, 0xffc5, 0xffff, 0xfffe, 0xfffe,
    0xfffd, 0xfffa, 0xfff4, 0xfffd, 0x0009, 0xffff, 0x0015, 0xfff9,
    0x0020, 0xffcd, 0x0006, 0xffd5, 0xffd6, 0xfff1, 0xfff4, 0xfffa,
    0xffff, 0xfff6, 0xfffa, 0xfffc, 0x0003, 0xfffb, 0x0008, 0xffee,
    0x0010, 0xfff6, 0x0019, 0xfff2, 0xfffd, 0x000f, 0xffe6, 0x001f,
    0xfff6, 0x000d, 0x0000, 0x0003, 0xfffe, 0x0005, 0x0000, 0x0005,
    0x0005, 0x0003, 0x0021, 0x0003, 0x0025, 0x0015, 0xffe1, 0x0029,
    0xffdd, 0x001d, 0x0005, 0x0012, 0xfffe, 0x0014, 0xfffc, 0x000f,
    0x0006, 0x0002, 0x001a, 0xfffc, 0x0032, 0xfff1, 0xffed, 0xfff7,
    0xffd3, 0x0005, 0x0005, 0x0007, 0xfffb, 0x0002, 0xfff7, 0xffff
};

#pragma DATA_SECTION(normalFlowU, "WBUF");
short normalFlowU[imW*imH];

#pragma DATA_SECTION(normalFlowV, "WBUF");
short normalFlowV[imW*imH];

#pragma DATA_SECTION(gt_nFlowU, "EOutdata");
short gt_nFlowU[imW*imH] =
{
    0x0000, 0x0000, 0xfffe, 0xfffe, 0x0000, 0x0002, 0xffff, 0xfffc, 
    0xfffc, 0x0000, 0x0008, 0x0001, 0x0001, 0x0001, 0x0002, 0x0001, 
    0xfee6, 0x00e1, 0x009b, 0x0000, 0x000b, 0x0036, 0xfff6, 0xff52, 
    0x0081, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0090, 
    0x0000, 0xfff1, 0x006e, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
    0x0000, 0x0000, 0x0000, 0xffd9, 0x0000, 0x0000, 0x0000, 0x0000, 
    0x0000, 0x0000, 0x0000, 0xff60, 0x0000, 0x0000, 0x0000, 0x0000

};
#pragma DATA_SECTION(gt_nFlowV, "EOutdata");
short gt_nFlowV[imW*imH] =
{
    0xffe5, 0xffdd, 0xffde, 0xffe6, 0xffe6, 0xffe3, 0xffdc, 0xffe2, 
    0x0053, 0x0058, 0x0053, 0x0053, 0x0054, 0x0051, 0x0050, 0x0058, 
    0x00ea, 0x022b, 0x0075, 0x011a, 0x00f4, 0x00f2, 0x00fe, 0x0134, 
    0xffea, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xffce, 
    0x0000, 0x006c, 0x0027, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 
    0x0000, 0x0000, 0x0000, 0x0032, 0x0000, 0x0000, 0x0000, 0x0000, 
    0x0000, 0x0000, 0x0000, 0xffb4, 0x0000, 0x0000, 0x0000, 0x0000

};

#pragma DATA_SECTION(profile_array, "WBUF");
unsigned int profile_array[2]; 

void generate_TLU_m(short *Emag, short *LUT, int elemsize, short *TLU_m_inv)
{
    int i;
    short m, m_inv;
    int T=10; //Threshold
    for(i=0; i<elemsize;i++)
    {
        m = Emag[i];
        m_inv = LUT[m];
        if (m<T)
            m_inv = 0;
        TLU_m_inv[i] = m_inv;
        printf("i: %d, m: %d, m_inv: %d \n",i, m, TLU_m_inv[i]);
    }

}

int main()
{
    int i, fail_x,fail_y;
#ifdef REPORT
#ifdef SCTM
unsigned int sctm_t1, sctm_t2, exec_diff;
unsigned int overflow;
#endif
FILE* fpReport = fopen("../../../report.csv","a+");
#endif

    fail_x = 0; 
	fail_y = 0;
    /*---------------------------------------------------------------------*/
    /*  Function call to the VCOP-C API to be tested                       */
    /*---------------------------------------------------------------------*/

    #if VCOP_HOST_EMULATION
    #else
        unsigned int t0, t1;
        _tsc_start();
    #endif

    
   for (i = 0; i < 2; i++)
   {    
    #if VCOP_HOST_EMULATION
    #else
    t0 = _tsc_gettime();
    #endif     
    
    /*---------------------------------------------------------------------*/
    /*  Function call to the VCOP-C API to be tested                       */
    /*---------------------------------------------------------------------*/  
#ifdef REPORT
#ifdef SCTM
EVE_SCTM_Enable(CTM);
EVE_SCTM_CounterConfig(CTM, SCTM_Counter_0, VCOP_BUSY, SCTM_DURATION);
EVE_SCTM_CounterTimerEnable(CTM, SCTM_Counter_0);
sctm_t1 = EVE_SCTM_CounterRead (CTM, SCTM_Counter_0);
#endif
#endif
    
     vcop_normalFlow(imDiff, Emag, LUT, E, TLU_m_inv, 10, imW*imH, normalFlowU, normalFlowV);
	 
#ifdef REPORT	
#ifdef SCTM
sctm_t2 = EVE_SCTM_CounterRead (CTM, SCTM_Counter_0);
overflow= EVE_SCTM_OverflowCheck(CTM,SCTM_Counter_0);
assert(overflow!=1);

exec_diff = sctm_t2 - sctm_t1;	
EVE_SCTM_CounterTimerDisable(CTM, SCTM_Counter_0);	
#endif			
#endif

    #if VCOP_HOST_EMULATION
    #else
    t1 = _tsc_gettime();
    profile_array[i]  = (t1 - t0);
    #endif  

       
   }      


    /*---------------------------------------------------------------------*/
    /*  Compare the results of output arrays with expected output arrays.  */
    /*---------------------------------------------------------------------*/

 #ifdef REPORT
fprintf(fpReport,"vcop_normalFlow,");
fprintf(fpReport,"%d,",imW);
fprintf(fpReport,"%d,",imH);
fprintf(fpReport,"%d,",imW);
fprintf(fpReport,"%d,",imH);
fprintf(fpReport,"%d,",1);

#endif   	
    fail_x = memcmp(normalFlowU, gt_nFlowU, imW*imH);

    /*---------------------------------------------------------------------*/
    /*  If there is a mis-compare, print out a memory trace, else print    */
    /*  pass.                                                              */
    /*---------------------------------------------------------------------*/

    if (fail_x)
        {
#ifdef CONSOLE 
            for (i = 0; i < imW*imH; i++)
            {
                printf ("i:%d, out:%d, EOut:%d, %c \n",
                      i, normalFlowU[i], gt_nFlowU[i],
                      (normalFlowU[i]!= gt_nFlowU[i]) ? '*':' '
                    );
            }
#endif
        }
    else     {
#ifdef CONSOLE
	printf ("Pass in X direction\n");
#endif
	}

    fail_y = memcmp(normalFlowV, gt_nFlowV, imW*imH);
    
    /*---------------------------------------------------------------------*/
    /*  If there is a mis-compare, print out a memory trace, else print    */
    /*  pass.                                                              */
    /*---------------------------------------------------------------------*/

    if (fail_y)
        {
#ifdef CONSOLE
            for (i = 0; i < imW*imH; i++)
            {
                printf ("i:%d, out:%d, EOut:%d, %c \n",
                      i, normalFlowV[i], gt_nFlowV[i],
                      (normalFlowV[i]!= gt_nFlowV[i]) ? '*':' '
                    );
            }
#endif
        }
    else {
#ifdef CONSOLE
	printf ("Pass in Y direction\n");
#endif
	}
	
    if(!fail_x && !fail_y){
#ifdef CONSOLE
	printf("Pass\n");
#endif
#ifdef REPORT
    fprintf(fpReport,"PASS,");
#endif
	}
	else	{
#ifdef CONSOLE
	printf("Fail\n");
#endif
#ifdef REPORT
    fprintf(fpReport,"FAIL,");
#endif
	}


   #if VCOP_HOST_EMULATION
   #else
#ifdef CONSOLE
    for (i = 0; i < 2; i++)
   printf ("Time taken: %d cycles \n", profile_array[i]);
#endif
   #endif   
#ifdef REPORT		
#ifdef SCTM
fprintf(fpReport,"%d\n",exec_diff);
#endif
if(fpReport){
fclose(fpReport);
}
#endif		

}

/* ======================================================================== */
/*  End of file:  vcop_normalFlow.c                                         */
/* ------------------------------------------------------------------------ */
/*            Copyright (c) 2012 Texas Instruments, Incorporated.           */
/*                           All Rights Reserved.                           */
/* ======================================================================== */

